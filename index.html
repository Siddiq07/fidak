<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Art Fest | Portal</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

<style>
/* ================================
   ROOT VARIABLES
================================ */
:root{
  --primary:#4f46e5;
  --secondary:#22c55e;
  --danger:#ef4444;
  --dark:#0f172a;
  --muted:#64748b;
  --bg:#f5f8ff;
  --card:#ffffff;
  --radius:16px;
}

/* ================================
   RESET & BASE
================================ */
*{
  box-sizing:border-box;
}
html,body{
  margin:0;
  padding:0;
  width:100%;
  min-height:100%;
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  background:var(--bg);
  color:var(--dark);
}
a{ text-decoration:none }
img{ max-width:100%; display:block }

/* ================================
   CONTAINERS
================================ */
.container-app{
  max-width:1200px;
  margin:auto;
  padding:16px;
}

.card-ui{
  background:var(--card);
  border-radius:var(--radius);
  padding:20px;
  box-shadow:0 20px 50px rgba(15,23,42,.08);
  margin-bottom:16px;
}

/* ================================
   HEADER / NAV
================================ */
.top-nav{
  background:#fff;
  border-bottom:1px solid #e5e7eb;
  position:sticky;
  top:0;
  z-index:1000;
}
.top-nav-inner{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 18px;
}
.brand{
  font-weight:800;
  font-size:20px;
  color:var(--primary);
  display:flex;
  gap:10px;
  align-items:center;
}
.nav-actions{
  display:flex;
  gap:10px;
}

/* ================================
   BUTTONS
================================ */
.btn-main{
  background:linear-gradient(90deg,var(--primary),#7c3aed);
  color:#fff;
  border:none;
  border-radius:14px;
  padding:12px 18px;
  font-weight:600;
  cursor:pointer;
}
.btn-outline{
  background:#fff;
  border:2px solid var(--primary);
  color:var(--primary);
  border-radius:14px;
  padding:12px 18px;
  font-weight:600;
  cursor:pointer;
}
.btn-danger{
  background:var(--danger);
  color:#fff;
  border:none;
  border-radius:14px;
  padding:12px 18px;
}
.btn-small{
  padding:8px 12px;
  border-radius:10px;
  font-size:13px;
}

/* ================================
   STATS / DASHBOARD BOXES
================================ */
.stats-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:14px;
}
.stat-box{
  background:#f1f5ff;
  border-radius:14px;
  padding:16px;
  text-align:center;
}
.stat-box h3{
  margin:0;
  font-weight:900;
  font-size:26px;
}
.stat-box span{
  font-size:13px;
  color:var(--muted);
}

/* ================================
   SCOREBOARD
================================ */
.scoreboard{
  margin-top:16px;
}
.score-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px 0;
  border-bottom:1px dashed #e5e7eb;
}
.score-item:last-child{ border-bottom:none }
.score-item strong{
  font-size:18px;
}

/* ================================
   TABLES
================================ */
.table-wrap{
  overflow-x:auto;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:10px;
  text-align:left;
  font-size:14px;
}
thead{
  background:#eef2ff;
}
tr:nth-child(even){
  background:#f8faff;
}

/* ================================
   ATTENDANCE BOXES
================================ */
.small-box{
  width:56px;
  height:38px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:8px;
  background:#e5e7eb;
  font-weight:700;
  cursor:pointer;
}
.small-box.present{
  background:var(--secondary);
  color:#fff;
}
.small-box.absent{
  background:var(--danger);
  color:#fff;
}

/* ================================
   MODALS
================================ */
.modal-content{
  border-radius:20px;
}
.modal-header{
  border-bottom:none;
}
.modal-footer{
  border-top:none;
}

/* ================================
   UTILITIES
================================ */
.text-muted{ color:var(--muted) }
.text-center{ text-align:center }
.mt-2{ margin-top:8px }
.mt-3{ margin-top:16px }
.mb-2{ margin-bottom:8px }
.mb-3{ margin-bottom:16px }

/* ================================
   MOBILE RESPONSIVE
================================ */
@media(max-width:768px){
  .top-nav-inner{
    flex-direction:column;
    gap:10px;
  }

  .brand{
    font-size:18px;
  }

  .btn-main,
  .btn-outline{
    width:100%;
    padding:14px;
  }

  .card-ui{
    padding:16px;
  }

  th,td{
    font-size:13px;
    padding:8px;
  }

  .small-box{
    width:44px;
    height:34px;
    font-size:12px;
  }
}

/* ================================
   ANIMATIONS
================================ */
.fade-in{
  animation:fade .5s ease;
}
@keyframes fade{
  from{opacity:0;transform:translateY(8px)}
  to{opacity:1;transform:none}
}
</style>
</head>

<body>
<div class="container d-flex align-items-center justify-content-center min-vh-100">
  <div class="card-ui w-100">

    <div class="text-center mb-4">
      <h2 class="fw-bold">ðŸŽ¨ Art Fest</h2>
      <div class="text-muted">Management Portal</div>
    </div>

    <div class="d-grid gap-3">
      <button class="btn btn-primary" id="btnAdmin">
        <i class="bi bi-shield-lock"></i> Admin Login
      </button>
      <button class="btn btn-success" id="btnLeader">
        <i class="bi bi-people"></i> Leader Login
      </button>
      <button class="btn btn-outline-primary" id="btnParticipant">
        <i class="bi bi-person"></i> Participant Login
      </button>
    </div>

    <div class="stats">
      <div class="stat">
        <h4 id="statStudents">0</h4>
        <small>Students</small>
      </div>
      <div class="stat">
        <h4 id="statEvents">0</h4>
        <small>Programs</small>
      </div>
      <div class="stat">
        <h4 id="statTeams">0</h4>
        <small>Teams</small>
      </div>
    </div>

    <div class="mt-4">
      <h6 class="fw-bold">Live Team Scores</h6>
      <div id="scoreList" class="small text-muted">Loadingâ€¦</div>
    </div>

  </div>
</div>

<!-- LOGIN MODAL -->
<div class="modal fade" id="loginModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <form id="loginForm">
        <div class="modal-header">
          <h5 class="modal-title" id="loginTitle">Login</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <input type="hidden" id="loginType">

          <div class="mb-3 d-none" id="teamBox">
            <label class="form-label">Team</label>
            <select id="teamSelect" class="form-select"></select>
          </div>

          <div class="mb-3">
            <label class="form-label">Password</label>
            <input id="passwordInput" type="password" class="form-control">
          </div>

          <div id="loginError" class="text-danger small d-none"></div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-primary w-100">Login</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";

document.addEventListener("DOMContentLoaded", () => {

  const firebaseConfig = {
    apiKey: "AIzaSyBMDGNukeonNa_-PWB-5cTO4GMofd3vyiM",
    databaseURL: "https://gen7-3e139-default-rtdb.firebaseio.com",
    projectId: "gen7-3e139"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const statStudents = document.getElementById("statStudents");
  const statEvents = document.getElementById("statEvents");
  const statTeams = document.getElementById("statTeams");
  const scoreList = document.getElementById("scoreList");
  const teamSelect = document.getElementById("teamSelect");

  window.TEAMS = {};

  onValue(ref(db,"students"), s => {
    statStudents.textContent = Object.keys(s.val()||{}).length;
  });

  onValue(ref(db,"events"), s => {
    statEvents.textContent = Object.keys(s.val()||{}).length;
  });

  onValue(ref(db,"teams"), s => {
    const teams = s.val()||{};
    window.TEAMS = teams;
    statTeams.textContent = Object.keys(teams).length;

    teamSelect.innerHTML = `<option value="">Select Team</option>`;
    scoreList.innerHTML = "";

    Object.values(teams)
      .sort((a,b)=>(b.score||0)-(a.score||0))
      .forEach(t=>{
        teamSelect.innerHTML += `<option value="${t.id}">${t.name}</option>`;
        scoreList.innerHTML += `
          <div class="score-item">
            <span>${t.name}</span>
            <strong>${t.score||0}</strong>
          </div>`;
      });
  });
});
</script>

<script>
document.addEventListener("DOMContentLoaded", ()=>{
  const modal = new bootstrap.Modal(document.getElementById("loginModal"));
  const loginForm = document.getElementById("loginForm");
  const loginType = document.getElementById("loginType");
  const teamBox = document.getElementById("teamBox");
  const loginTitle = document.getElementById("loginTitle");
  const passwordInput = document.getElementById("passwordInput");
  const teamSelect = document.getElementById("teamSelect");
  const loginError = document.getElementById("loginError");

  btnAdmin.onclick = ()=> open("admin");
  btnLeader.onclick = ()=> open("leader");
  btnParticipant.onclick = ()=> location.href="participant.html";

  function open(type){
    loginType.value = type;
    teamBox.classList.toggle("d-none", type!=="leader");
    loginTitle.textContent = type.toUpperCase()+" LOGIN";
    loginError.classList.add("d-none");
    modal.show();
  }

  loginForm.onsubmit = e => {
    e.preventDefault();
    const type = loginType.value;
    const pwd = passwordInput.value;

    if(type==="admin"){
      if(pwd!=="1234"){ error("Wrong admin password"); return; }
      location.href="admin.html";
    }

    if(type==="leader"){
      const team = Object.values(window.TEAMS).find(t=>String(t.id)===teamSelect.value);
      if(!team || team.password!==pwd){
        error("Invalid team or password"); return;
      }
      sessionStorage.setItem("leaderAuth", JSON.stringify(team));
      location.href=`leader.html?leader=${team.leaderId}`;
    }
  };

  function error(msg){
    loginError.textContent = msg;
    loginError.classList.remove("d-none");
  }
});
</script>

</body>
</html>